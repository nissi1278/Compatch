<%= turbo_frame_tag dom_id(participant) do %>
  <%= form_with(model: [participant.group, participant], data: { controller: "adjustment-form" }) do |f| %>
    <div class="border border-gray-200 rounded-lg p-4 mb-2">
      
      <div class="flex items-center justify-between mb-4">
        <span class="font-bold text-lg"><%= participant.name %></span>
        <%= link_to [participant.group, participant],
                    data: { turbo_method: :delete,
                            turbo_confirm: "#{participant.name}さんを削除しますか？" },
                    class: "text-red-500 text-sm hover:underline" do %>
          <%= render 'shared/trash_icon' %>
        <% end %>
      </div>

      <%= f.hidden_field :is_manual_fixed, data: { "adjustment-form-target": "isManualFixedField" } %>
      <%= f.hidden_field :payment_amount, data: { "adjustment-form-target": "paymentAmountField" } %>

      <div class="flex items-center space-x-2 mb-4">
        <button type="button" class="btn btn-primary text-sm"
                data-action="click->adjustment-form#toggleFixed"
                data-adjustment-form-target="fixedButton">
          金額を固定する
        </button>
      </div>

      <div class="grid grid-cols-3 gap-2 mb-4">
        <button type="button" class="btn btn-primary text-sm"
                data-action="click->adjustment-form#applyAdjustment"
                data-adjustment-value="1000">+1000円
        </button>
        <button type="button" class="btn btn-primary text-sm"
                data-action="click->adjustment-form#applyAdjustment"
                data-adjustment-value="-2000">飲んでない
        </button>
        <button type="button" class="btn btn-primary text-sm"
                data-action="click->adjustment-form#applyAdjustment"
                data-adjustment-value="-1000">-1000円
        </button>
      </div>

      <div class="relative">
        <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">¥</span>
        <input 
          type="number" 
          value="<%= participant.payment_amount %>" 
          class="w-full pl-8 pr-12 py-3 border border-gray-300 rounded-lg text-right"
          placeholder="0"
          data-adjustment-form-target="displayAmount"
          data-action="input->adjustment-form#manualUpdate"
        />
        <span class="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500">円</span>
      </div>
    </div>
  <% end %>
<% end %>