<%= turbo_frame_tag dom_id(participant) do %>
  <%= form_with(model: [participant.group, participant], data: { controller: "adjustment-form" }) do |form| %>
    <div class="border border-gray-200 rounded-lg p-4 mb-2">
      
      <div class="flex items-center justify-between mb-4">
        <span class="font-bold text-lg"><%= participant.name %></span>
        <%= link_to [participant.group, participant],
                    data: { turbo_method: :delete,
                            turbo_confirm: "#{participant.name}さんを削除しますか？" },
                    class: "text-red-500 text-sm hover:underline" do %>
          <%= render 'shared/trash_icon' %>
        <% end %>
      </div>

      <%= form.hidden_field :is_manual_fixed,
                         data: { "adjustment-form-target": "isManualFixedField" } %>
      <%= form.hidden_field :payment_amount,
                         data: { "adjustment-form-target": "paymentAmountField" } %>

      <div class="grid grid-cols-3 gap-2 mb-4">
        <button type="button"
                class="btn btn-primary text-sm"
                data-action="click->adjustment-form#applyAdjustment"
                data-adjustment-value="1000"
                data-adjustment-form-target="editableElement"
                <%= 'disabled' unless participant.is_manual_fixed? %>>
          +1000円
        </button>
        <button type="button"
                class="btn btn-primary text-sm"
                data-action="click->adjustment-form#applyAdjustment"
                data-adjustment-value="-2000"
                data-adjustment-form-target="editableElement"
                <%= 'disabled' unless participant.is_manual_fixed? %>>
          飲んでない
        </button>
        <button type="button"
                class="btn btn-primary text-sm"
                data-action="click->adjustment-form#applyAdjustment"
                data-adjustment-value="-1000"
                data-adjustment-form-target="editableElement"
                <%= 'disabled' unless participant.is_manual_fixed? %>>
          -1000円
        </button>
      </div>

      <div class="flex items-center space-x-2">
        <div class="shrink-0">
          <%= render "shared/manual_fixed_icon", is_manual_fixed: participant.is_manual_fixed? %>
        </div>
        <div class="relative w-full">
          <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">¥</span>
          <%= form.number_field :payment_amount,
              class: "w-full pl-8 pr-12 py-3 border border-gray-300 rounded-lg text-right",
              placeholder: "0",
              data: { "adjustment-form-target": "displayAmount editableElement",
                      action: "input->adjustment-form#manualUpdate" },
              disabled: !participant.is_manual_fixed?
          %>
          <span class="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500">円</span>
          <%= inline_error_for(form, :payment_amount) %>
        </div>
      </div>
    </div>
  <% end %>
<% end %>